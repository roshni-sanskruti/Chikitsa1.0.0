CREATE OR REPLACE VIEW %dbprefix%view_patient  AS SELECT patient.patient_id AS patient_id,       patient.blood_group AS blood_group,	   patient.clinic_id AS clinic_id,	   patient.patient_since AS patient_since,	   patient.age AS age,	   patient.display_id AS display_id,	   patient.gender AS gender,	   patient.dob AS dob,	   patient.reference_by AS reference_by,	patient.reference_by_detail AS reference_by_detail,	   patient.followup_date AS followup_date,	   (SELECT SUM(patient_account.adjust_amount) FROM %dbprefix%patient_account patient_account WHERE patient_account.patient_id = patient.patient_id) AS in_account_amount,	   contacts.display_name AS display_name,contacts.contact_id AS contact_id,contacts.first_name AS first_name,contacts.middle_name AS middle_name,contacts.last_name AS last_name,(SELECT contact_details.detail FROM %dbprefix%contact_details contact_details WHERE ((contact_details.contact_id = contacts.contact_id) AND (contact_details.type = 'mobile')) LIMIT 1) AS phone_number,contacts.email AS email from (%dbprefix%patient patient left join %dbprefix%contacts contacts on((patient.contact_id = contacts.contact_id))) ;
UPDATE %dbprefix%version SET current_version='0.7.5';